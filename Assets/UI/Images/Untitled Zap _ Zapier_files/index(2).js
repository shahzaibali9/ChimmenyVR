import{a as he}from"./bf7f34c4cc5e2083773de944d3d5adde49463506-chunk-2WR4Q4GB.js";import{a as ae,b as Ke,c as Ht,d as $t,e as qt,f as Nr,g as gn,h as L,j as We,k as vn,l as bn}from"./bf7f34c4cc5e2083773de944d3d5adde49463506-chunk-NJLHEIR6.js";import{a as fn,b as hn,f as yn}from"./bf7f34c4cc5e2083773de944d3d5adde49463506-chunk-CFWQHN7V.js";import{a as mn}from"./bf7f34c4cc5e2083773de944d3d5adde49463506-chunk-K3EKYHSZ.js";import{c as U,d as Ue,e as zt,f as Q,g as Vt,k as on,m as sn,o as an,q as cn,s as dn,t as ln,u as un,v as pn}from"./bf7f34c4cc5e2083773de944d3d5adde49463506-chunk-LO2YQQ4X.js";import{n as En,q as Sn}from"./bf7f34c4cc5e2083773de944d3d5adde49463506-chunk-VOUNXVKB.js";import"./bf7f34c4cc5e2083773de944d3d5adde49463506-chunk-HZVXVJ6F.js";import{a as jt,b as Gt,d as ee,e as Yt,h as ce,i as te}from"./bf7f34c4cc5e2083773de944d3d5adde49463506-chunk-KRXOJUZ3.js";import"./bf7f34c4cc5e2083773de944d3d5adde49463506-chunk-IYCCWYCQ.js";import{a as Dt,b as Lt,c as Fe,d as Rt,e as Ft,f as Kt,i as Ut,j as Wt,k as q}from"./bf7f34c4cc5e2083773de944d3d5adde49463506-chunk-6CBQ6KG6.js";import"./bf7f34c4cc5e2083773de944d3d5adde49463506-chunk-HHT3V5F6.js";import{a as ot,c as lt,d as ut,f as pt,h as gt,j as ft,k as R,l as ht,m as ue,q as Zt,r as fe}from"./bf7f34c4cc5e2083773de944d3d5adde49463506-chunk-YXE54WDO.js";import{a as at,b as ct}from"./bf7f34c4cc5e2083773de944d3d5adde49463506-chunk-YLFDGR2D.js";import{$ as V,$a as Bt,$b as rn,Ca as kt,Da as _t,Db as Jt,E as yt,Ea as Mt,Eb as Qt,F,Ga as At,Gb as en,Ha as Pt,Ia as Nt,Ib as tn,Ja as se,K as Ae,Kb as nn,Oa as Y,P as Pe,Pa as De,Q as vt,S as bt,Sa as Ot,T as Et,Xa as Le,Y as Ne,_ as Oe,aa as K,ab as Re,b as Pr,c as C,d as x,db as ge,e as d,f as A,g as it,h as P,ha as St,i as X,ia as j,j as st,k as w,l as dt,ma as wt,n as mt,na as Be,o as T,oa as J,pa as It,q as B,r as ie,ra as G,sb as Xt,ta as Ct,ua as Tt,va as pe,wa as me,ya as xt}from"./bf7f34c4cc5e2083773de944d3d5adde49463506-chunk-5YBTRID6.js";d();d();(function(){try{var t=typeof window<"u"||typeof window<"u"?window:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},e=new t.Error().stack;e&&(t._sentryDebugIds=t._sentryDebugIds||{},t._sentryDebugIds[e]="b58f785a-0bc6-4d23-aee4-618602d090c1",t._sentryDebugIdIdentifier="sentry-dbid-b58f785a-0bc6-4d23-aee4-618602d090c1")}catch(n){}})();d();var Tr=C(A()),xr=C(ot());d();var we=C(A());d();var v=C(A());d();if(typeof document<"u"){let t=document.createElement("style"),e=window.engagement,n=e&&e._configuration&&e._configuration.nonce;if(n)t.setAttribute("nonce",n);else{let r=document.querySelector("[nonce]");if(r){let o=r.nonce||r.getAttribute("nonce");o&&t.setAttribute("nonce",o)}}t.appendChild(document.createTextNode(`#engagement-wrapper *,
#engagement-wrapper *:before,
#engagement-wrapper *:after,
.engagement-nudge-modal *,
.engagement-nudge-modal *:before,
.engagement-nudge-modal *:after,
.engagement-nudge-modal-mock *,
.engagement-nudge-modal-mock *:before,
.engagement-nudge-modal-mock *:after {
  box-sizing: border-box;
}

.engagement-modal > .rc-dialog > .rc-dialog-content {
  background-color: transparent;
}

.engagement-tooltip {
  z-index: 2147483647 !important; /*make the tooltip the highest possible z index*/
}

/*** Hack: Hide this because it's less flexible (classnames can't be changes)
    Instead we only show its children, by translating its children ***/
.engagement-modal > .rc-dialog > .rc-dialog-content > .rc-dialog-header {
  max-height: 0px !important;
  padding: 0px !important;
}

.engagement-modal > .rc-dialog {
  left: 0px;
  transition: left 0.3s;
}

.engagement-modal > .rc-dialog > .rc-dialog-content > .rc-dialog-body {
  position: relative !important;
}

/* TestMode inline engagement */
.engagement-modal-inline.rc-dialog-wrap {
  position: relative;
  height: 100%;
}

#engagement-container > div {
  height: 100%;
}

#engagement-home > .rc-dialog-root {
  height: 100%;
}

#engagement-wrapper .rc-header-guidance {
  background: rgba(174, 177, 221, 1) !important;
  filter: brightness(135%);
  border-radius: 2px 2px 0px 0px !important;
  border-bottom: 0px !important;
  padding: 8px 30px 2px 30px !important;
  margin: 0px 10px 0px 10px;
  box-shadow: rgba(0, 0, 0, 0.15) 0px 3px 10px !important;
  font-weight: 400;
  text-align: center;
}

@keyframes fontbulger {
  0% {
    font-size: 10px;
  }
  30% {
    font-size: 15px;
  }
  100% {
    font-size: 12px;
  }
}

@keyframes shimmer {
  0% {
    background-position: top left;
  }
  100% {
    background-position: top right;
  }
}

.engagement-category-collapse {
  transform: scale(1, -1);
  transition: 0.3s ease-in;
  cursor: pointer;
}

.engagement-category-expand {
  transition: 0.3s ease-in;
  cursor: pointer;
}

/* Nudges - modal */

.engagement-nudge-modal {
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 2147483644 !important;
}

.engagement-nudge-modal-mock {
  display: flex;
  align-items: center;
  justify-content: center;
  margin-right: 0;
  transition: margin-right cubic-bezier(0.78, 0.14, 0.15, 0.86) 0.3s;
  z-index: 2147483644 !important;
}

/* Nudges - media */

.engagement-help-doc-title::before {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: linear-gradient(180deg, transparent 66.67%, gray 93.08%);
  content: '';
}

/* Recorder */
#engagement-recorder-mask {
  background: transparent;
}
`)),document.head.appendChild(t)}d();if(typeof document<"u"){let t=document.createElement("style"),e=window.engagement,n=e&&e._configuration&&e._configuration.nonce;if(n)t.setAttribute("nonce",n);else{let r=document.querySelector("[nonce]");if(r){let o=r.nonce||r.getAttribute("nonce");o&&t.setAttribute("nonce",o)}}t.appendChild(document.createTextNode(`/*** Guidance banner styling and animation ***/
@keyframes example {
  from {
    transform: translateY(0px);
  }
  to {
    transform: translateY(-30px);
  }
}

.rc-header-guidance {
  animation: example 0.5s;
  animation-fill-mode: forwards;
}

/*** engagement entry animation ***/
/*** We can't do exit animation because rc-dialog makes display: none ***/
@keyframes onEntry {
  0% {
    opacity: 0.3;
  }
  100% {
    opacity: 1;
  }
}

.engagement-opened {
  animation: onEntry 0.1s;
  animation-fill-mode: forwards;
}

@keyframes onSelect {
  0% {
    transform: translate3d(0px, 0px, 0px);
  }
  50% {
    transform: translate3d(0px, 0px, -0.5px);
  }
  100% {
    transform: translate3d(0px, 0px, 0px);
  }
}

.engagement-selected {
  animation: onSelect 0.4s;
}

@keyframes ScaleEntry {
  from {
    transform: scale(0.8);
    opacity: 0;
  }
  to {
    transform: scale(1);
    opacity: 1;
  }
}

.engagement-scale-entry-animation {
  animation: ScaleEntry 0.3s;
  animation-fill-mode: forwards;
}

@keyframes onEntry {
  0% {
    opacity: 0.3;
  }
  100% {
    opacity: 1;
  }
}

.engagement-shortcut-tooltip {
  opacity: 0;
  animation: tagEntry 0.2s;
  animation-delay: 0.5s;
  animation-fill-mode: forwards;
}

@keyframes tagExit {
  from {
    transform: scale(1);
    opacity: 1;
  }
  to {
    transform: scale(0.8);
    opacity: 0;
  }
}

.engagement-shortcut-tooltip-remove {
  animation: tagExit 0.2s;
  animation-fill-mode: forwards;
}

.engagement-shortcut-tooltip,
.engagement-shortcut-tooltip-remove {
  z-index: 99999999;
  position: absolute;
  padding: 8px 12px;
  background-color: rgba(0, 0, 0, 0.8);
  font-family: proxima-nova, sans-serif;
  color: rgba(255, 255, 255, 0.6);
  border-radius: 4px;
  font-size: 13px;
}

.engagement-shortcut-tooltip-tag {
  margin-left: 10px;
  padding: 2px 5px;
  border-radius: 2px;
  background-color: grey;
}

#engagement-launcher {
  animation: 0.25s ease-out scaleIn;
}

@keyframes scaleIn {
  0% {
    transform: scale(0.06);
  }
  100% {
    transform: scale(1);
  }
}

@keyframes growFromBottom {
  0% {
    transform: scale(1, 0.3);
  }

  100% {
    transform: scale(1, 1);
  }
}
`)),document.head.appendChild(t)}d();var He=class{constructor(){x(this,"organization")}getOrganization(){return this.organization}setOrganization(e){this.organization=e}},wn=new He;d();var ne=C(A()),Or=(t=document.body)=>{var o,i;let e=(0,ne.useRef)(null),n=(0,ne.useRef)(null),r=(0,ne.useRef)(null);return(0,ne.useEffect)(()=>()=>{var s,a;(s=n.current)==null||s.disconnect(),(a=e.current)==null||a.remove()},[]),(e.current===null||t!==r.current)&&((o=n.current)==null||o.disconnect(),(i=e.current)==null||i.remove(),r.current=t,e.current=document.createElement("div"),e.current.setAttribute("data-engagement-toplevel-styles",""),e.current.setAttribute("hidden",""),t.prepend(e.current),n.current=new MutationObserver(()=>{e.current&&e.current.querySelectorAll("style[data-emotion]:not([data-s])").forEach(s=>{s.setAttribute("data-s","")})}),n.current.observe(e.current,{childList:!0,subtree:!0})),e.current},In=Or;d();var de=C(A());var Br=({nudgeActor:t})=>{var m;let e=T(),n=Q(t,({context:u})=>u.nudge),r=Q(t,({context:u})=>u.stepIndex),{animStyles:o}=fe(),i=G(n,r);if(!i||!(me(i)&&i.formFactor.isShowingMask))return null;let{targetElement:s}=qt(e,{step:i}),a=(m=s==null?void 0:s.getBoundingClientRect())!=null?m:new DOMRect,c=s?getComputedStyle(s).borderRadius:"0px";return a.width===0||a.height===0?null:de.default.createElement("div",{style:{position:"absolute",top:"0",left:"0",...ie.getZIndexStyles(i,"mask")}},de.default.createElement("div",{"data-testid":"engagement-nudge-mask",style:{width:`${document.documentElement.scrollWidth}px`,height:`${document.documentElement.scrollHeight}px`,clipPath:`polygon(0% 0%, 0% 100%,
                ${a.left+window.scrollX}px 100%,
                ${a.left+window.scrollX}px ${a.top+window.scrollY}px,
                ${a.left+window.scrollX+a.width}px ${a.top+window.scrollY}px,
                ${a.left+window.scrollX+a.width}px ${a.top+window.scrollY+a.height}px,
                0% ${a.top+window.scrollY+a.height}px,
                0% 100%, 100% 100%, 100% 0%)`,position:"absolute"}}),de.default.createElement("div",{"data-testid":"engagement-nudge-mask-inner",style:{pointerEvents:"none",position:"absolute",inset:`${a.top+window.scrollY}px ${a.left+window.scrollX}px`,width:`${a.width}px`,height:`${a.height}px`,padding:"4px",borderRadius:`${c}`,boxShadow:`0 0 0 ${Math.max(document.documentElement.scrollHeight,document.documentElement.scrollWidth)}px rgba(0, 0, 0, 0.1)`,overflow:"hidden",opacity:o.opacity,transitionProperty:"opacity",transitionDuration:o.transitionDuration,transitionTimingFunction:o.transitionTimingFunction}}))},Cn=({nudgesManager:t})=>{let e=T(),n=Q(t,o=>o.context.activeNudge);if(!n)return null;let r=K(e,n==null?void 0:n.variantId);return r?de.default.createElement(Br,{nudgeActor:r}):null};d();var Tn=t=>{if(t.themeOverride&&t.themeOverride.theme&&t.themeOverride.mode)return t.themeOverride;let e=t.themeMode==="auto"?t.services.getDefaultUIMode():t.themeMode;return{theme:ft(t.themes),mode:e}};d();var W=C(A()),ve=C(A());var $={state:{},subscribers:[],subscribe:t=>($.subscribers.push(t),()=>{$.subscribers=$.subscribers.filter(e=>e!==t)})},Dr=(t,e)=>{switch(e.type){case"SHOW":return{...t,[e.id]:e.payload};case"HIDE":{let n={...t};return delete n[e.id],n}case"HIDE_ALL_MATCHING_PATTERN":if(e.idPattern){let n={...t};for(let r in n)r.match(e.idPattern)&&delete n[r];return n}return{};default:return t}},$e=t=>{let e=Dr($.state,t);$.state=e,$.subscribers.forEach(n=>n(e))},xn=(t,e)=>{$e({type:"SHOW",id:t,payload:e})},kn=t=>{$e({type:"HIDE_ALL_MATCHING_PATTERN",idPattern:t})},ze=t=>{let e=document.querySelector(`[data-spacer-for="${t}"]`);e&&e.remove(),$e({type:"HIDE",id:t})},_n=({children:t})=>{let{isEditorPreview:e}=T(),[n,r]=(0,ve.useState)($.state);return(0,ve.useEffect)(()=>$.subscribe(r),[]),W.default.createElement(W.default.Fragment,null,t,W.default.createElement("div",{id:"engagement-nudges-banner-sticky-container",style:{width:"100%",top:"0px",left:0,position:"fixed",pointerEvents:"none",height:"100%"}},Object.entries(n).filter(([,o])=>o.sticky).map(([o,i])=>W.default.createElement("div",{key:o,id:o},i.element))),W.default.createElement("div",{id:"engagement-nudges-banner-inline-container-top",style:{width:"100%",position:"absolute",top:e?"50%":"0",left:0,pointerEvents:"none"}},Object.entries(n).filter(([,o])=>!o.sticky&&o.position==="top").map(([o,i])=>W.default.createElement("div",{key:o,id:o},i.element))),W.default.createElement("div",{id:"engagement-nudges-banner-inline-container-bottom",style:{width:"100%",position:e?void 0:"relative",pointerEvents:"none"}},Object.entries(n).filter(([,o])=>!o.sticky&&o.position==="bottom").map(([o,i])=>W.default.createElement("div",{key:o,id:o},i.element))))};d();var Pn=C(Nr()),Z=C(A());d();var k=C(A());var Lr=B.div`
  height: ${Fe}px;
  position: relative;
  z-index: 50;

  @media screen and (max-height: 820px) {
    transform: scale(0.9);
  }

  @media screen and (max-height: 760px) {
    transform: scale(0.8);
  }
`,Rr=B.div`
  width: ${Rt}px;
  height: ${Fe}px;
  position: relative;
  border-radius: 56px;
  box-shadow: 0px 0px 0px 7.5px #7d7e7d;
  border: 8px solid #000;
  background: linear-gradient(165deg, white, #ebf0ff 45%, #ebf0ff 55%, white);
  outline: 6px solid #2c2c2b;
  padding-top: 60px;
  padding-bottom: 34px;
  overflow: hidden;

  @media screen and (max-width: 670px) {
    height: 790px;
    width: 400px;
  }

  #engagement-nudge-container {
    overflow: auto;
  }
`,Fr=B.div`
  height: 100%;
  width: 100%;
  position: relative;
`,Kr=B.div`
  position: absolute;
  width: 100%;
  height: 60px;
  top: 0px;
  display: flex;
  justify-content: center;
  padding-top: 12px;
`,Ur=B.div`
  height: 37px;
  width: 126px;
  border-radius: 24px;
  background-color: #000000;
  transition: height 0.5s cubic-bezier(0.075, 0.82, 0.165, 1), width 0.5s cubic-bezier(0.075, 0.82, 0.165, 1);

  &:hover {
    height: 45px;
    width: 145px;
  }
`,Wr=B.div`
  position: absolute;
  width: 100%;
  height: 34px;
  bottom: 0px;
  display: flex;
  align-items: center;
  justify-content: center;
  padding-bottom: 8px;
`,Hr=B.div`
  height: 5px;
  width: 154px;
  border-radius: 24px;
  background-color: #000000;
`,$r=B.div`
  position: absolute;
  height: 100%;
  width: 100%;
  top: 0px;
  bottom: 0px;
`,Mn=B.div`
  position: absolute;
  top: 120px;
  display: flex;
  flex-direction: column;

  &.left {
    left: -12px;
  }

  &.right {
    right: -12px;
    top: 220px;
  }
`,be=B.span`
  background-color: #1d1e1f;
  display: inline-block;
  width: 5px;
  min-height: 62px;
  border-radius: 2px;

  &.power {
    height: 102px;
  }

  &.volume-up {
    margin-top: 29px;
  }
  &.volume-down {
    margin-top: 16px;
  }

  &.lock {
    min-height: 32px;
  }
`,zr=()=>k.default.createElement($r,null,k.default.createElement(Mn,{className:"left"},k.default.createElement(be,{className:"lock"}),k.default.createElement(be,{className:"volume-up"}),k.default.createElement(be,{className:"volume-down"})),k.default.createElement(Mn,{className:"right"},k.default.createElement(be,{className:"power"}))),Vr=()=>k.default.createElement(Kr,null,k.default.createElement(Ur,null)),An=({style:t,children:e})=>{let{isMobileDevice:n,isMobileNativePreview:r}=q();return k.default.createElement(Lr,{style:t,"data-testid":"mobile-preview-device"},k.default.createElement(zr,null),k.default.createElement(Rr,{isMobileWeb:n&&!r},k.default.createElement(Vr,null),k.default.createElement(Fr,{id:"engagement-mobile-preview-wrapper"},k.default.createElement("div",{id:"engagement-mobile-nudge-mock-pin"}),e),k.default.createElement(Wr,null,k.default.createElement(Hr,null))))};var jr=({children:t})=>{let e=Z.default.useRef(null),{widgetTableauSelection:n,editorPreviewDevice:r}=T(),{mode:o}=R(),i=Z.default.useCallback(c=>{if(!c){e.current&&(e.current.dispose(),e.current=null);return}if(e.current=(0,Pn.default)(c,{maxZoom:1,minZoom:1,initialZoom:1,zoomDoubleClickSpeed:1,smoothScroll:!1,filterKey:function(){return!0}}),e.current.on("pan",function(){document.body.style.cursor="grab",c.style.pointerEvents="none"}),e.current.on("panend",function(){document.body.style.cursor="auto",c.style.removeProperty("pointer-events")}),!!c.children[0])return c.addEventListener("mousedown",s),c.addEventListener("wheel",a),()=>{c.removeEventListener("mousedown",s),c.removeEventListener("wheel",a)}},[n]),s=c=>{var f,l;let m=c.target;(m==null?void 0:m.id)==="panzoom-container"?(f=e.current)==null||f.resume():(l=e.current)==null||l.pause()},a=c=>{var f,l;let m=c.target;(m==null?void 0:m.id)==="panzoom-container"?(f=e.current)==null||f.resume():(l=e.current)==null||l.pause()};return Z.default.createElement("div",{style:{position:"absolute",inset:0,overflow:"clip",backgroundColor:o==="lightMode"?"#F9F9F9":"#3F424A",backgroundImage:"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAABZSURBVHgB7dG7DYBADANQJxexAiXSTXw9uyExBih34SOxQhr83Li2ASIiIiIiIvo7QbLW1jms1zijq9puSDaGLxhhuBPaqyKZTFK+/q6AZOJlg8shqv5ccAGZWRnaKiSy9QAAAABJRU5ErkJggg==)"}},Z.default.createElement("div",{id:"panzoom-container",style:{width:"100%",height:"100%"},ref:i},t,Z.default.createElement("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",width:"100%",height:"100%"}},Z.default.createElement(An,{style:{visibility:r.startsWith("mobile")?"visible":"hidden"}}))))},Nn=jr;d();var I=C(A()),Ve=C(ot());d();var re=C(A());d();var On=C(A());var Gr={display:"flex",width:"var(--popover-width)",flexDirection:"column",alignItems:"flex-start",pointerEvents:"all",maxWidth:"var(--tooltip-max-width)",position:"relative",borderRadius:"var(--layout-radius-card)",borderWidth:"1px",borderStyle:"solid",borderColor:"var(--border-primary)",background:"var(--background-primary)",boxShadow:"var(--layout-shadow) var(--layout-shadow-color)",a:{color:"var(--content-link)",textDecoration:"none","&:hover":{color:"var(--content-link-hover)",textDecoration:"underline"}}},Yr={minWidth:"var(--popover-width)",width:"unset",maxWidth:"unset"},qr=B.div``,Zr=On.default.forwardRef(({children:t,title:e,variant:n,theme:r,...o},i)=>pt(qr,{ref:i,css:[Gr,n==="survey"&&Yr].filter(Boolean),...o},t)),Bn=Zr;var Dn=({nudge:t,step:e,renderMode:n,handleLinkClick:r,stepIndex:o,isVisible:i=!0})=>{let s=T(),a=R(),c=n!==1?K(s,t.variantId):void 0,{isMobileDevice:m}=q(),u=re.default.createElement(un,{isDismissible:t.isDismissible,"data-testid":"engagement-nudge-tooltip-close"},re.default.createElement(rn,null));return re.default.createElement(ue,{nudge:t},re.default.createElement(Bn,{variant:e.content.find(f=>f.type==="survey_rating")?"survey":"default",key:e.id,theme:a,style:{minHeight:44,pointerEvents:i?"auto":"none",...e.formFactor.layout==="horizontal"&&!m?{width:"auto",maxWidth:"calc(var(--tooltip-max-width) * 2)"}:{}}},re.default.createElement(yn,{nudge:t,step:e,renderMode:n,handleLinkClick:r,stepIndex:o,actor:c,overrides:{close:u}})))};d();var Ln=C(A());var Xr={bookClosed:Xt,helpCircle:Jt,helpSquare:Qt,infoCircle:en,lightBulb:tn,lightning:nn},Rn=({type:t})=>{let e=Xr[t];return Ln.default.createElement(e,{color:"#3F424A",size:16})};d();var Se=C(A());var Fn=zt({types:{},guards:{shouldCenter:()=>!1,isInlineAligned:()=>!1},actions:{updatePosition:Ue({marker:({context:t},e)=>({...t.marker,position:e.position})}),assignInlineWrapper:Ue({inlineWrapperElement:(t,e)=>e.inlineWrapperElement}),removeTooltip:()=>{},trackMarkerInView:()=>{},handleHide:()=>{}},actors:{waitForTargetElement:U(()=>{}),trackTargetElement:U(()=>{}),wrapTargetElement:U(()=>{}),trackMarkerInView:U(()=>{})}}).createMachine({id:"Tooltip",initial:"idle",context:({input:t})=>({marker:{ref:t.markerRef,position:null,offset:t.offset,alignment:t.alignment},renderMode:t.renderMode,anchor:t.anchor}),states:{idle:{always:[{target:"centered",guard:"shouldCenter",description:"This is the case when we are editing a step in the studio and the target element is unavailable."},"waiting for target element"]},centered:{type:"final"},anchoring:{initial:"hidden",invoke:{src:"trackTargetElement",id:"trackTargetElement",input:({context:t,event:e})=>({marker:t.marker,targetElement:"targetElement"in e?e.targetElement:null})},states:{shown:{on:{HIDE:{target:"#Tooltip.anchoring.hidden"}},states:{visible:{entry:[{type:"trackMarkerInView"}],on:{OUT_OF_VIEW:"hidden"},exit:[{type:"handleHide"}]},hidden:{on:{IN_VIEW:"visible"}}},initial:"hidden",invoke:{src:"trackMarkerInView",id:"trackMarkerInView",input:({context:t})=>({markerRef:t.marker.ref})}},hidden:{on:{SHOW:"shown"}}},on:{POSITION:{actions:[{type:"updatePosition",params:({event:t})=>({position:t.position})}]},TARGET_ELEMENT_REMOVED:"waiting for target element"}},inlining:{invoke:{src:"wrapTargetElement",id:"wrapTargetElement",input:({context:t,event:e})=>({marker:t.marker,targetElement:"targetElement"in e?e.targetElement:null})},states:{idle:{on:{ASSIGN_WRAPPER:{target:"inlined",actions:[{type:"assignInlineWrapper",params:({event:t})=>({inlineWrapperElement:t.inlineWrapperElement})}]}}},inlined:{states:{hidden:{on:{IN_VIEW:"visible"}},visible:{entry:[{type:"trackMarkerInView"}],on:{OUT_OF_VIEW:"hidden"}}},initial:"hidden",invoke:{src:"trackMarkerInView",id:"trackMarkerInView",input:({context:t})=>({markerRef:t.marker.ref})}}},initial:"idle",on:{TARGET_ELEMENT_REMOVED:"waiting for target element"}},"waiting for target element":{on:{TARGET_ELEMENT_FOUND:[{target:"inlining",guard:"isInlineAligned"},"anchoring"]},invoke:{src:"waitForTargetElement",id:"waitForTargetElement"}}},on:{DESTROY:{actions:[{type:"removeTooltip"}]}}}),M=Vt(Fn),Kn=({variantId:t,children:e,renderMode:n,offset:r,alignment:o,anchor:i,handleDestroy:s,onMarkerView:a,handleHide:c})=>{let{isEditorPreview:m}=T(),{showWidgetTableau:u,messageBus:f}=T(),l=(0,Se.useRef)(null),h=Fn.provide({guards:{shouldCenter:({context:p})=>!u&&m||n===1&&!ee(p.anchor),isInlineAligned:()=>o==="inline_left"||o==="inline_right"},actions:{removeTooltip:s,trackMarkerInView:a,handleHide:c},actors:{waitForTargetElement:U(({sendBack:p})=>{let b=ee(i);if(ce(b))return p({type:"TARGET_ELEMENT_FOUND",targetElement:b});let g=()=>{let y=ee(i);ce(y)&&p({type:"TARGET_ELEMENT_FOUND",targetElement:y})};return f.subscribe("dom_mutation",g,`tooltip_wait_for_target_${t}`),()=>{f.unsubscribe("dom_mutation",`tooltip_wait_for_target_${t}`)}}),trackTargetElement:U(({sendBack:p,input:b})=>{let{marker:g,targetElement:y}=b;if(!y)return;let S=g.ref.current;if(!S)return;let{offset:E,alignment:N}=g,D=on(y,S,()=>{var O,H,Qe,et,tt,nt;cn(y,S,{placement:N==="left"?"left":"right",strategy:"fixed",middleware:[sn({mainAxis:L(E.x),crossAxis:L(E.y)}),an({strategy:"escaped",padding:{top:L((O=E==null?void 0:E.y)!=null?O:"0"),bottom:-L((H=E==null?void 0:E.y)!=null?H:"0"),...N==="left"?{right:-L((Qe=E==null?void 0:E.x)!=null?Qe:"0"),left:L((et=E==null?void 0:E.x)!=null?et:"0")}:{right:L((tt=E==null?void 0:E.x)!=null?tt:"0"),left:-L((nt=E==null?void 0:E.x)!=null?nt:"0")}}})]}).then(({y:_r,x:Mr,middlewareData:Ar})=>{var rt;p({type:"POSITION",position:{x:Mr,y:_r}}),(rt=Ar.hide)!=null&&rt.escaped?p({type:"HIDE"}):p({type:"SHOW"})})});return f.subscribe("dom_mutation",()=>{(!document.contains(y)||!ce(y))&&p({type:"TARGET_ELEMENT_REMOVED"})},`tooltip_check_for_target_removal_${t}`),()=>{D(),f.unsubscribe("dom_mutation",`tooltip_check_for_target_removal_${t}`)}}),wrapTargetElement:U(({sendBack:p,input:b})=>{var E,N;let{marker:g,targetElement:y}=b;if(!y)return;let S=document.createElement("div");return S.setAttribute("data-testid","engagement-nudge-tooltip-wrapper"),S.style.position="relative",S.style.display="inline-flex",S.style.alignItems="baseline",S.style.width="fit-content",S.style.flexDirection=g.alignment==="inline_right"?"row":"row-reverse",(E=y.parentNode)==null||E.insertBefore(S,y),(N=y.parentNode)==null||N.removeChild(y),S.appendChild(y),p({type:"ASSIGN_WRAPPER",inlineWrapperElement:S}),f.subscribe("dom_mutation",()=>{(!document.contains(y)||!ce(y))&&p({type:"TARGET_ELEMENT_REMOVED"})},`tooltip_check_for_target_removal_wrap_${t}`),()=>{let _=S.parentNode;document.contains(_)&&(_==null||_.insertBefore(y,S),_==null||_.removeChild(S)),f.unsubscribe("dom_mutation",`tooltip_check_for_target_removal_wrap_${t}`)}}),trackMarkerInView:U(({sendBack:p,input:b})=>{let g=new IntersectionObserver(([y])=>{y.isIntersecting?p({type:"IN_VIEW"}):p({type:"OUT_OF_VIEW"})});return b.markerRef.current&&g.observe(b.markerRef.current),()=>{g.disconnect()}})}});return Se.default.createElement(M.Provider,{logic:h,options:{input:{markerRef:l,offset:r,alignment:o,renderMode:n,anchor:i}}},e)};var Jr=({source:t})=>{let e=t.startsWith("<svg");return I.default.createElement("div",{style:{pointerEvents:"auto"}},e?I.default.createElement("div",{dangerouslySetInnerHTML:{__html:t}}):I.default.createElement("img",{alt:"Tooltip marker",src:t}))},Qr=({type:t})=>I.default.createElement("div",{"data-testid":"engagement-nudge-tooltip-icon",style:{border:"none",display:"flex",background:"none",padding:0,position:"relative",pointerEvents:"auto",width:"16px",height:"16px"}},I.default.createElement(Rn,{type:t})),eo=({marker:t})=>{let e=R();switch(t.type){case"image":return t.source?I.default.createElement(Jr,{source:t.source}):null;case"icon":return I.default.createElement(Qr,{type:t.icon});case"beacon":return I.default.createElement(gn,{theme:e});default:return null}},to=({step:t})=>{let{isMobileDevice:e}=q(),n=M.useSelector(p=>p.matches({anchoring:"shown"})||p.matches("centered")),r=M.useSelector(({context:p})=>p.marker.alignment),o=r==="inline_left"||r==="left",i={visibility:n?"visible":"hidden",top:"calc(40vh - 51px)",right:`calc(-${e?o?40:60:o?20:80}vw + 24px)`},s=M.useSelector(({context:p})=>{var b;return(b=p.marker.position)==null?void 0:b.y}),a=M.useSelector(({context:p})=>{var b;return(b=p.marker.position)==null?void 0:b.x}),c={visibility:n?"visible":"hidden",left:a,top:s},m={visibility:"visible"},u=M.useSelector(p=>p.matches({inlining:"inlined"})&&!!p.context.inlineWrapperElement),f=M.useSelector(p=>p.matches("centered")),l=()=>u?m:f?i:c,h=M.useSelector(({context:p})=>p.marker.ref);return I.default.createElement(dn,{ref:h,"data-testid":"engagement-nudge-tooltip-marker",style:{...l()}},I.default.createElement(eo,{marker:t.formFactor.marker}))},no=({nudge:t,step:e,popoverActor:n})=>{var h,p,b;let r=Q(n,g=>g.matches("open")),{onExit:o}=fe(),{isStudioMobilePreview:i}=q(),s=T(),a=M.useSelector(({context:g})=>g.renderMode),c=a!==1?K(s,t.variantId):void 0,m=(p=(h=c==null?void 0:c.getSnapshot())==null?void 0:h.context.stepIndex)!=null?p:0,u=(0,I.useCallback)(()=>o(()=>{var g,y;return(y=(g=c==null?void 0:c.getSnapshot())==null?void 0:g.context.popoverActor)==null?void 0:y.send({type:"CLOSE"})}),[c==null?void 0:c.getSnapshot,o]),f=fn(g=>se.nudge.engaged(t,m,{...c==null?void 0:c.getSnapshot().context,source:{type:"link",url:g},interactionState:j(s,t.variantId)}),u),l=M.useSelector(g=>g.matches({inlining:"inlined"})&&!!g.context.inlineWrapperElement);return(0,I.useEffect)(()=>{c==null||c.send({type:"ASSIGN_POPOVER_ACTOR",actor:n})},[n,c]),(0,I.useEffect)(()=>{a===1&&n.send({type:"OPEN"})},[a,e]),I.default.createElement(I.default.Fragment,null,I.default.createElement(to,{step:e}),I.default.createElement(ln,{"data-testid":"engagement-nudge-tooltip-content",describedBy:"engagement-nudge-tooltip-content",labelledBy:"engagement-nudge-title",portalToId:i?"engagement-mobile-preview-wrapper":l?"engagement-toast-container":void 0,shouldStealFocus:a!==1,showArrow:((b=e.formFactor.pointer)==null?void 0:b.type)==="arrow",style:{borderRadius:"var(--layout-radius-card)",...ie.getZIndexStyles(e)}},I.default.createElement(hn,{actor:c,step:e},I.default.createElement(mn,null,I.default.createElement(Dn,{nudge:t,step:e,renderMode:a,stepIndex:m,handleLinkClick:f,isVisible:r})))))},ro=({nudge:t,step:e,onOpen:n,forceOpen:r=!1,autoPlacement:o=!0,root:i})=>{let s=M.useSelector(({context:g})=>g.renderMode),a=M.useSelector(g=>g.matches("idle")),c=M.useSelector(g=>g.matches({inlining:"inlined"})&&!!g.context.inlineWrapperElement),m=M.useSelector(({context:g})=>g.inlineWrapperElement),u=M.useSelector(({context:g})=>g.marker.offset),{generatedCSSClassname:f}=R();if(a)return null;let[l,h]=[L(u.x),L(u.y)],p=c?{display:"flex",position:"relative",[e.formFactor.marker.positioning.position==="inline_left"?"marginRight":"marginLeft"]:`${l}px`,marginTop:`${h}px`,zIndex:"auto"}:{...ie.getZIndexStyles(e)};if(!i)return null;let b=(0,Ve.createPortal)(I.default.createElement(pn,{"data-testid":`engagement-tooltip-${t.variantId}-${String(e.id)}${s===1?"-mock":""}`,forceOpen:r,defaultOpen:s===1,triggerType:e.formFactor.showOn,style:p,className:f,autoPlacement:o,onOpen:n},g=>I.default.createElement(no,{nudge:t,step:e,popoverActor:g})),i);return c&&m?(0,Ve.createPortal)(b,m):b},Un=({nudge:t,step:e,renderMode:n,forceOpen:r,anchorOverride:o,onMarkerView:i,onOpen:s,handleDestroy:a,autoPlacement:c})=>{var f;let m=T(),u=(0,I.useRef)(document.getElementById("engagement-tooltip-container-portal"));return u.current?I.default.createElement(ue,{nudge:t},I.default.createElement(Zt,{widget:"tooltip",keepMounted:!0,isOpenByDefault:n===1},I.default.createElement(Kn,{variantId:t.variantId,offset:e.formFactor.marker.positioning.offset,renderMode:n,alignment:e.formFactor.marker.positioning.position,anchor:(f=o!=null?o:e.formFactor.anchorSelector)!=null?f:e.formFactor.anchor,handleDestroy:a,onMarkerView:i,handleHide:()=>{var p;let l=K(m,t.variantId),h=(p=l==null?void 0:l.getSnapshot())==null?void 0:p.context.popoverActor;h==null||h.send({type:"CLOSE"})}},I.default.createElement(ro,{onOpen:s,autoPlacement:c,forceOpen:r,nudge:t,step:e,root:u.current})))):null};var io=v.default.lazy(()=>import("./bf7f34c4cc5e2083773de944d3d5adde49463506-Checklist-SPOXT4XX.js")),so=v.default.lazy(()=>import("./bf7f34c4cc5e2083773de944d3d5adde49463506-Nudges-KKI5RTNR.js")),ao=v.default.lazy(()=>import("./bf7f34c4cc5e2083773de944d3d5adde49463506-WidgetTableau-AFCPLLLG.js")),co=v.default.lazy(()=>import("./bf7f34c4cc5e2083773de944d3d5adde49463506-ResourceCenterRoot-QAMLU34S.js")),lo=()=>{let t=T(),{generatedCSSClassname:e}=R(),n=()=>v.default.createElement(v.default.Fragment,null,v.default.createElement(v.Suspense,{fallback:null},v.default.createElement(so,null)),t.nudgesManager&&v.default.createElement(Cn,{nudgesManager:t.nudgesManager}),v.default.createElement($t,{containerStyle:{marginTop:t.isEditorPreview?"51px":void 0}}),v.default.createElement("div",{id:"engagement-tooltip-container-portal"}),v.default.createElement(_n,null)),r=()=>v.default.createElement(v.Suspense,{fallback:null},v.default.createElement(io,null)),o=i=>{var s,a;return t.resourceCenter?v.default.createElement(v.Suspense,{fallback:null},v.default.createElement(co,{isEnabled:!!t.resourceCenter.key&&!!((a=(s=t.decide)==null?void 0:s[t.resourceCenter.key])!=null&&a.value),isPreviewPane:i,isVisible:t.resourceCenter.visible,launcher:t.resourceCenter.desktopLauncher})):null};return v.default.createElement("div",{className:e,id:"engagement-theme-root",dir:"ltr"},t.showWidgetTableau?v.default.createElement(v.Suspense,{fallback:null},v.default.createElement(ao,null)):t.isEditorPreview?v.default.createElement(Nn,null,r(),n(),o(!0)):v.default.createElement(v.default.Fragment,null,r(),n(),o(!1)))},uo=({children:t})=>{var a,c,m;let e=T(),{organization:n}=e,r=(0,v.useRef)(!!e.user),o=document.getElementById("engagement-wrapper"),i=In(o!=null?o:document.head),s=(0,v.useMemo)(()=>{var l,h;let u=it(),f=(p,b,g,y,S,E,N,_)=>{if(p!==-1)return;let D="#engagement-wrapper",O=g[0];O&&O.includes(".")&&(g[0]=`${D} ${O}${O}`)};return lt({key:"engagement-toplevel",container:i,speedy:!((l=e.flags)!=null&&l["support-ruby-on-rails"]),nonce:(h=u[P])==null?void 0:h.nonce,stylisPlugins:[f]})},[i,(a=e.flags)==null?void 0:a["support-ruby-on-rails"]]);return(0,v.useEffect)(()=>{wn.setOrganization(n)},[n]),v.default.useEffect(()=>{e.user&&(e.services.postMessageToDashboard("ENGAGEMENT_BOOTED"),r.current||(r.current=!0))},[(c=e.user)==null?void 0:c.device_id,(m=e.user)==null?void 0:m.user_id,n]),v.default.useEffect(()=>{let u=setTimeout(()=>{r.current||w.warn("\u{1F44B} Guides and Surveys are almost ready. You just need to call `boot()` to make them available in your app.")},15e3);return()=>clearTimeout(u)},[]),v.default.createElement(v.default.Fragment,null,v.default.createElement(ut,{value:s},e.user?v.default.createElement(lo,null):null,t))},po=t=>{let e=T(),n=Tn(e),r={container:document.getElementById("engagement-container"),root:document};return v.default.createElement(gt.Provider,{value:r},v.default.createElement(ht,{theme:n.theme,mode:n.mode},v.default.createElement(uo,{...t})))},Wn=po;var Hn=t=>we.default.createElement(ct,null,we.default.createElement(dt,{store:t.store},we.default.createElement(Wn,null,t.children)));d();d();var Ie=(t,e)=>{let n={};return Object.keys(e).forEach(r=>{n[r]=e[r].bind(null,t)}),n};var je={};Pr(je,{previewAutopilotKeywords:()=>jn,previewContentItem:()=>Gn,previewRecSet:()=>zn,previewResourceCenter:()=>Vn,setInitialPage:()=>Yn,showResourceCenter:()=>$n});d();d();var $n=(t,e)=>{t.services.showResourceCenter(t,e)},zn=(t,e)=>{t.services.previewRecSet(t,e)},Vn=(t,e,n)=>{t.services.previewResourceCenter(t,e,n)},jn=(t,e)=>{t.services.previewAutopilotKeywords(t,e)},Gn=(t,e)=>{t.services.setCurrentContentId(t,e)},Yn=(t,e)=>{t.resourceCenter.initialPage=e};d();var mo=t=>{var e,n,r,o;return typeof window>"u"||typeof document>"u"?t:{...t,event_properties:{...t.event_properties,"[Guides-Surveys] Page":{domain:(e=window.location)==null?void 0:e.hostname,hash:(n=window.location)==null?void 0:n.hash,path:(r=window.location)==null?void 0:r.pathname,query:(o=window.location)==null?void 0:o.search,title:document.title}}}},go=t=>({...t,event_properties:{...t.event_properties,"[Guides-Surveys] Version":"1"}}),fo=t=>(t=go(t),t=mo(t),t),Ce=class{constructor(e){x(this,"hasBooted",!1);x(this,"integrations");this.integrations=e}trackEvent(e,n={}){this.track(e,n)}track(e,n={}){var o,i;let r={event_type:e,event_properties:n};if(!this.hasBooted){w.warn("Events cannot be tracked before `boot` is called");return}try{let s=fo(r);w.debug("Tracking event",JSON.stringify(s,null,2));try{this.integrations().forEach(a=>{var c;(c=a.track)==null||c.call(a,{event_type:s.event_type,event_properties:s.event_properties})})}catch(a){(o=F())==null||o.captureException(a)}}catch(s){w.error("Unexpected error logging event; ignoring",{error:s}),(i=F())==null||i.captureException(s)}}setBootStatus(e){this.hasBooted=e}};d();var ho=function(){function t(){}return t.prototype.getApplicationContext=function(){return{versionName:this.versionName,language:yo(),platform:"Web",os:void 0,deviceModel:void 0}},t}(),yo=function(){return typeof navigator<"u"&&(navigator.languages&&navigator.languages[0]||navigator.language)||""},vo=function(){function t(){this.queue=[]}return t.prototype.logEvent=function(e){this.receiver?this.receiver(e):this.queue.length<512&&this.queue.push(e)},t.prototype.setEventReceiver=function(e){this.receiver=e,this.queue.length>0&&(this.queue.forEach(function(n){e(n)}),this.queue=[])},t}(),z=function(){return z=Object.assign||function(e){for(var n,r=1,o=arguments.length;r<o;r++){n=arguments[r];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},z.apply(this,arguments)};function Te(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function qn(t,e){var n=typeof Symbol=="function"&&t[Symbol.iterator];if(!n)return t;var r=n.call(t),o,i=[],s;try{for(;(e===void 0||e-- >0)&&!(o=r.next()).done;)i.push(o.value)}catch(a){s={error:a}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(s)throw s.error}}return i}var xe=function(t,e){var n,r,o=["string","number","boolean","undefined"],i=typeof t,s=typeof e;if(i!==s)return!1;try{for(var a=Te(o),c=a.next();!c.done;c=a.next()){var m=c.value;if(m===i)return t===e}}catch(g){n={error:g}}finally{try{c&&!c.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}if(t==null&&e==null)return!0;if(t==null||e==null||t.length!==e.length)return!1;var u=Array.isArray(t),f=Array.isArray(e);if(u!==f)return!1;if(u&&f){for(var l=0;l<t.length;l++)if(!xe(t[l],e[l]))return!1}else{var h=Object.keys(t).sort(),p=Object.keys(e).sort();if(!xe(h,p))return!1;var b=!0;return Object.keys(t).forEach(function(g){xe(t[g],e[g])||(b=!1)}),b}return!0},bo="$set",Eo="$unset",So="$clearAll";Object.entries||(Object.entries=function(t){for(var e=Object.keys(t),n=e.length,r=new Array(n);n--;)r[n]=[e[n],t[e[n]]];return r});var wo=function(){function t(){this.identity={userProperties:{}},this.listeners=new Set}return t.prototype.editIdentity=function(){var e=this,n=z({},this.identity.userProperties),r=z(z({},this.identity),{userProperties:n});return{setUserId:function(o){return r.userId=o,this},setDeviceId:function(o){return r.deviceId=o,this},setUserProperties:function(o){return r.userProperties=o,this},setOptOut:function(o){return r.optOut=o,this},updateUserProperties:function(o){var i,s,a,c,m,u,f=r.userProperties||{};try{for(var l=Te(Object.entries(o)),h=l.next();!h.done;h=l.next()){var p=qn(h.value,2),b=p[0],g=p[1];switch(b){case bo:try{for(var y=(a=void 0,Te(Object.entries(g))),S=y.next();!S.done;S=y.next()){var E=qn(S.value,2),N=E[0],_=E[1];f[N]=_}}catch(H){a={error:H}}finally{try{S&&!S.done&&(c=y.return)&&c.call(y)}finally{if(a)throw a.error}}break;case Eo:try{for(var D=(m=void 0,Te(Object.keys(g))),O=D.next();!O.done;O=D.next()){var N=O.value;delete f[N]}}catch(H){m={error:H}}finally{try{O&&!O.done&&(u=D.return)&&u.call(D)}finally{if(m)throw m.error}}break;case So:f={};break}}}catch(H){i={error:H}}finally{try{h&&!h.done&&(s=l.return)&&s.call(l)}finally{if(i)throw i.error}}return r.userProperties=f,this},commit:function(){return e.setIdentity(r),this}}},t.prototype.getIdentity=function(){return z({},this.identity)},t.prototype.setIdentity=function(e){var n=z({},this.identity);this.identity=z({},e),xe(n,this.identity)||this.listeners.forEach(function(r){r(e)})},t.prototype.addIdentityListener=function(e){this.listeners.add(e)},t.prototype.removeIdentityListener=function(e){this.listeners.delete(e)},t}(),le=typeof globalThis<"u"?globalThis:typeof window<"u"?window:self,ke=function(){function t(){this.identityStore=new wo,this.eventBridge=new vo,this.applicationContextProvider=new ho}return t.getInstance=function(e){return le.analyticsConnectorInstances||(le.analyticsConnectorInstances={}),le.analyticsConnectorInstances[e]||(le.analyticsConnectorInstances[e]=new t),le.analyticsConnectorInstances[e]},t}();d();var Ge=["boot"],Zn=["boot"],Ye="$default_instance";function Xn(t){var o,i,s,a,c,m,u;let e=window.engagement,n={_q:(o=e==null?void 0:e._q)!=null?o:[],_configuration:{apiKey:(s=(i=e==null?void 0:e._configuration)==null?void 0:i.apiKey)!=null?s:"",serverUrl:(a=e==null?void 0:e._configuration)==null?void 0:a.serverUrl,serverZone:(m=(c=e==null?void 0:e._configuration)==null?void 0:c.serverZone)!=null?m:"US",options:{...(u=e==null?void 0:e._configuration)==null?void 0:u.options}},_sentry:void 0,init(f,l){var p,b,g;if(n._configuration.apiKey){console.log("Engagement SDK has already been initialized. Ignoring additional init call.");return}n._configuration={...n._configuration,...l,apiKey:f,options:{splitting:!0,...n._configuration.options,...l==null?void 0:l.options}},(b=(p=n._configuration)==null?void 0:p.options)!=null&&b.logger&&n._configuration.options.logger.enable((g=n._configuration.options.logLevel)!=null?g:2);let h;if(l!=null&&l.cdnUrl)n._configuration.options.splitting?h=`${l.cdnUrl}/engagement-browser/prod/split/index.js`:h=l.cdnUrl+"/engagement-browser/prod/index.min.js.gz";else{let y=n._configuration.serverZone==="EU"?"https://cdn.eu.amplitude.com":"https://cdn.amplitude.com";n._configuration.options.splitting?h=`${y}/engagement-browser/prod/split/index.js`:h=`${y}/engagement-browser/prod/index.min.js.gz`}t(h,n._configuration.options.splitting?"module":void 0,l==null?void 0:l.nonce)},plugin(f){let l=n.init;return{name:"@amplitude/engagement-browser",type:"enrichment",async setup(h,p){var y,S;let b=(y=h.instanceName)!=null?y:Ye,g=ke.getInstance(b).identityStore;l(h.apiKey,{serverZone:h.serverZone,serverUrl:(S=h.serverUrl)!=null&&S.includes("amplitude.com")?void 0:h.serverUrl,...f,options:{logLevel:h.logLevel,logger:h.loggerProvider,...f==null?void 0:f.options}}),await window.engagement.boot({user:()=>{let E=g.getIdentity();return{user_id:p.getUserId(),device_id:p.getDeviceId(),user_properties:E.userProperties,getSessionId:p.getSessionId}},integrations:[{track:E=>{p.track(E)}}]}),g.addIdentityListener(E=>{window.engagement._setUserProperties(E.userProperties)})},async execute(h){return window.engagement.forwardEvent(h),h}}}},r=n;return new Proxy(n,{get:function(f,l){if(l in r)return r[l];if(l!=="then")return l==="gs"||l==="rc"?new Proxy({},{get:function(h,p){return function(){let b=Array.from(arguments),g=`${l}.${p}`;b.unshift(g),n._q.push(b)}}}):Ge.includes(l)?function(){let h=Array.prototype.slice.call(arguments);return new Promise((p,b)=>{h.unshift(l,p,b),n._q.push(h)})}:function(){let h=Array.prototype.slice.call(arguments);h.unshift(l),n._q.push(h)}}})}var Io=["reloadOrganization","reloadNudges","reloadThemes"],Co={},_e=class{constructor(e,n){x(this,"_");x(this,"nudgeActions");x(this,"resourceCenterActions");x(this,"globalActions");x(this,"_analytics",new Ce(()=>this._.integrations));x(this,"_configuration",{serverZone:"US",serverUrl:void 0,apiKey:"",options:{...Co}});x(this,"_initStarted",!1);x(this,"_isProxy",!1);x(this,"_fingerprint");x(this,"_sentry");x(this,"gs",{reset:(e,n)=>{let r=Be(this._,e);if(!r){w.warn(`gs.reset: Guide or survey with flagKey: ${e} not found`);return}this.nudgeActions.resetNudge(r==null?void 0:r.variantId,{step:n})},list:()=>{let e=[],n=V(this._);if(!n)return e;for(let r of n.values()){let o=r.getSnapshot().context.nudge,i=j(this._,o.variantId),s=r.getSnapshot().matches({Step:"Render Loop"});!(i!=null&&i.activelifeCycleUuid)&&!s||e.push({id:o.variantId,step:i==null?void 0:i.currentStep,title:o.title,status:s?"visible":"active"})}return e},show:(e,n=0)=>{let r=Be(this._,e);r?(this.nudgeActions.closeAllNudgeMocks(),this.nudgeActions.forceTriggerSingleNudge(r,{source:{type:"sdk"},overrides:{stepIndex:n}})):w.error(`triggerNudge: Nudge with key: ${e} not found`)},closeAll:()=>{var e;(e=V(this._))==null||e.forEach(n=>{n==null||n.send({type:"DISMISS"})})}});x(this,"rc",{open:()=>{this.resourceCenterActions.showResourceCenter(!0)},close:()=>{this.resourceCenterActions.showResourceCenter(!1)},toggle:()=>{this.resourceCenterActions.showResourceCenter(!this._.resourceCenter.visible)}});var r,o;this._=e,this.nudgeActions=Ie(e,ge),this.resourceCenterActions=Ie(e,je),this.globalActions=Ie(e,Pt),this.setRouter=this.setRouter.bind(this),this.boot=this.boot.bind(this),this._startNudgeDebug=this._startNudgeDebug.bind(this),this.forwardEvent=this.forwardEvent.bind(this),this.addIntegration=this.addIntegration.bind(this),this.setThemeMode=this.setThemeMode.bind(this),this.addCallback=this.addCallback.bind(this),this.setSessionProperty=this.setSessionProperty.bind(this),this._initStarted=((r=window.engagement)==null?void 0:r._initStarted)===!0,this._configuration={...this._configuration,...n,options:{...this._configuration.options,...n.options}},this._configuration.options.logger&&this._configuration.options.logger.enable((o=this._configuration.options.logLevel)!=null?o:2),this._sentry=yt("https://86e449af9e7145de4804c2143988499b@o13027.ingest.us.sentry.io/4508580659462144")}init(e,n){var r;if(this._configuration.apiKey){w.warn("Engagement SDK has already been initialized. Ignoring additional init call.");return}this._configuration={...this._configuration,apiKey:e,...n,options:{...this._configuration.options,...n==null?void 0:n.options}},this._configuration.options.logger&&this._configuration.options.logger.enable((r=this._configuration.options.logLevel)!=null?r:2)}plugin(e){return{name:"@amplitude/engagement-browser",type:"enrichment",setup:async(o,i)=>{var c;let s=(c=o.instanceName)!=null?c:Ye,a=ke.getInstance(s).identityStore;await this.boot({user:()=>{let m=a.getIdentity();return{user_id:i.getUserId(),device_id:i.getDeviceId(),user_properties:m.userProperties,getSessionId:i.getSessionId}},integrations:[{track:m=>{i.track(m)}}]}),a.addIdentityListener(m=>{this._setUserProperties(m.userProperties)})},execute:async o=>(this.forwardEvent(o),o)}}setRouter(e){this.globalActions.addCallbacks({"engagement-router":e})}async updateLanguage(e){var o;this._configuration&&(this._configuration.locale=e);let r=(await Y(this._configuration.apiKey)).nudges;(o=V(this._))==null||o.forEach(i=>{let s=r.find(a=>a.variantId===i.getSnapshot().context.nudge.variantId);s&&(i==null||i.send({type:"REFRESH_NUDGE",nudge:s}))})}async boot(e){var n,r,o,i;if(typeof e.user=="function")try{this._.user=e.user()}catch(s){w.error("Failed to get user from provider function",s)}else typeof e=="string"?this._.user={user_id:e}:typeof e.user=="string"?this._.user={user_id:e.user}:this._.user=e.user;if(!this._.user||!this._.user.user_id&&!this._.user.device_id){w.error("User must specify at least a user_id or device_id"),this._.user=void 0;return}this._.integrations=[],(n=e.integrations)==null||n.forEach(s=>{this.addIntegration(s)}),w.log("booting...",JSON.stringify(this._.user,null,2));try{this._.decide=await Nt.decide(this._configuration.apiKey,this._.user,this._.isEditorPreview),w.debug("Decide data fetched successfully")}catch(s){w.error("Failed to fetch decide data",s),(r=F())==null||r.captureException(s)}try{await this._.endUserStore.fetchData(),this._.endUserStore.initializedSuccessfully&&(this._analytics.setBootStatus(!0),(o=this._.nudgesManager)==null||o.send({type:"END_USER_STORE_LOADED"}),w.debug("End user state loaded successfully"))}catch(s){w.error("Failed to fetch end user state",s),(i=F())==null||i.captureException(s)}}forwardEvent(e){typeof e=="string"&&(e={event_type:e}),w.debug(`Registering event ${e.event_type}`),At(this._,e.event_type,e.event_properties)}addIntegration(e){this._.integrations.push(e)}setThemeMode(e){["lightMode","darkMode","auto"].includes(e)&&(this._.themeMode=e)}addCallback(e,n){this.globalActions.addCallbacks({[e]:n})}setSessionProperty(e,n){if(!bt(e)){console.error("Invalid session property key",e);return}if(!Et(n)){console.error("Invalid session property value",n);return}this.globalActions.setSessionProperties({[e]:n})}async _configUser(){var a;(a=F())==null||a.addBreadcrumb({level:"debug",category:"internal",message:"_configUser called"});let{organization:e,nudges:n,flags:r,themes:o,resourceCenters:i}=await Y(this._configuration.apiKey,this._.isEditorPreview);this._.flags=r,this._.themes=o;let[s]=i;s&&(this._.resourceCenter={...this._.resourceCenter,...s}),this.globalActions.setOrganization(e),this.nudgeActions.initNudges(n||[]),this.nudgeActions.setupTimedTriggers([...n])}_updateEditorPreviewDevice(e){this._.editorPreviewDevice=e}_getEditorPreviewDevice(){return this._.editorPreviewDevice}async _reload(e=Io){let n=await Y(this._configuration.apiKey,this._.isEditorPreview);for(let r of e){let i=this[r];i instanceof Function&&i(n)}}async _reloadOrganization(e){let{organization:n}=e||await Y(this._configuration.apiKey,this._.isEditorPreview);this.globalActions.setOrganization(n)}async _reloadNudges(e){let{nudges:n}=e||await Y(this._configuration.apiKey,this._.isEditorPreview);this.nudgeActions.initNudges(n||[])}async _reloadThemes(e){let{themes:n}=e||await Y(this._configuration.apiKey,this._.isEditorPreview);this._.themes=n}_startNudgeDebug(e){let{nudge:n}=e;this.nudgeActions.closeAllNudgeMocks(),this.nudgeActions.startDebugSession(n,{refreshDecide:!0,toStepIndex:0})}async _stopNudgeDebug(){this.nudgeActions.stopDebugSession()}_showNudgeStepMock(e){var n;(n=V(this._))==null||n.forEach(r=>{r==null||r.send({type:"CLOSE"})}),this.nudgeActions.showStepMock(e.nudge,e.stepIndex,{forceOpen:e.forceOpen})}_closeNudgeMocks(){this.nudgeActions.closeAllNudgeMocks()}_setUserProperties(e){if(!this._.user){w.error("User is undefined, likely hasn't been booted yet");return}this._.user.user_properties={...this._.user.user_properties,...e}}_shareConfig(){return{organization:this._.organization||void 0,nudges:J(this._)}}_shareTrackedEvents(){return{trackedEvents:[...this._.trackedAppEvents]}}_startDebug(){X.set("debug:nudges","true"),w.log("Enabled debugging for nudges. Restart the application.")}_stopDebug(){X.remove("debug:nudges"),w.log("Disabled debugging for nudges. Restart the application.")}_showResourceCenter(e,n){this.resourceCenterActions.showResourceCenter(e),(n==null?void 0:n.recSet)!==void 0&&this.resourceCenterActions.previewRecSet(n.recSet),n!=null&&n.resourceCenter&&(n==null?void 0:n.quickLinks)!==void 0&&this.resourceCenterActions.previewResourceCenter(n.resourceCenter,n.quickLinks),(n==null?void 0:n.autopilotKeywords)!==void 0&&this.resourceCenterActions.previewAutopilotKeywords(n.autopilotKeywords),(n==null?void 0:n.contentItemId)!==void 0&&this.resourceCenterActions.previewContentItem(n.contentItemId)}_startChat(){this.resourceCenterActions.setInitialPage({item:{page:"chat",params:{}}}),this.resourceCenterActions.showResourceCenter(!0)}_getDebugSnapshot(e){if(e!=null&&e.variantId){if(typeof e.variantId=="number"){let r=wt(this._,e.variantId);if(r){let o=typeof e.stepIndex=="number"?e.stepIndex:0,i=Re(this._,r,o),{name:s}=Ne(r),a=`${s} debug snapshot: ${i.guideOrSurvey.title} - ${i.guideOrSurvey.variant}`;console.log(a,i)}}return}let n=J(this._);for(let r of n){let o=Re(this._,r),{name:i}=Ne(r),s=`${i} debug snapshot: ${o.guideOrSurvey.title} - ${o.guideOrSurvey.variant}`;console.log(s,o)}}_debugStatus(){console.log({user:this._.user,apiKey:this._configuration.apiKey,stateInitialized:this._.endUserStore.initializedSuccessfully,decideSuccessful:this._.decide!=null,num_guides_surveys:J(this._).length,analyticsIntegrations:this._.integrations.length})}_setTheme(e,n){e||(this._.themeOverride=void 0),this._.themeOverride={theme:e,mode:n}}_showWidgetTableau(e,n){this._.widgetTableauSelection=n,this._.showWidgetTableau=e}_addCallback(e,n){this.globalActions.addCallbacks({[e]:n})}_clearNudgeInteractions(e){e?this._.endUserStore.data={nudgeInteractions:{...this._.endUserStore.data.nudgeInteractions,[e]:Ae()}}:this._.endUserStore.data={nudgeInteractions:Object.fromEntries(Object.keys(this._.endUserStore.data.nudgeInteractions).map(n=>[n,Ae()]))},this._.endUserStore.pushData()}};d();var Jn=async(t,e)=>{let n=(a,c)=>{let m=c.split("."),u=a;for(let f of m){if(!(f in u)){w.warn(`Engagement SDK method ${c} is not defined.`);return}u=u[f]}return u},r=async a=>{let c=[...a],m=c.shift(),u=n(t,m);if(u)if(Ge.includes(m))if(c[0]instanceof Function){let f=c.shift(),l=c.shift();try{await u(...c).then(f,l)}catch(h){w.error(h)}}else await u(...c);else await u(...c)},i=(async a=>{do{let c=e.findIndex(u=>(u==null?void 0:u[0])===a);if(c===-1)break;let m=e.splice(c,1)[0];await r(m)}while(!0)})("boot"),s=[];for(;e.length>0;){let a=e.shift();if(!a)continue;let c=a[0];if(c==="boot"){s.push(a);continue}Zn.includes(c)?await r(a):r(a)}return e.length=0,i.then(async()=>{for(let a=0;a<s.length;a++){let c=s[a];await r(c)}}),t};d();var To=4,xo=500,ko=500,Qn=t=>{let e,n=0,r=0,o=()=>{let i=Date.now();i-r<=ko&&(n+=1,clearTimeout(e),e=setTimeout(()=>n=0,xo)),r=i,n>=To&&(t.messageBus.publish("rage_click"),n=0,clearTimeout(e))};return document.body.addEventListener("click",o),()=>{document.body.removeEventListener("click",o)}};d();var er=t=>{let i=0,s=-1,a=-1,c=-1,m,u=f=>{let{clientX:l,clientY:h,timeStamp:p}=f;if(s!==-1&&a!==-1&&c!==-1){let b=Math.abs(l-s),g=Math.abs(h-a);Math.sqrt(b**2+g**2)/(p-c)>5&&p-c<=100&&(i+=1,clearTimeout(m),m=setTimeout(()=>i=0,500)),i>=15&&(t.messageBus.publish("user_confusion"),i=0,clearTimeout(m))}s=l,a=h,c=p};return document.body.addEventListener("mousemove",u),()=>{document.body.removeEventListener("mousemove",u)}};d();var tr=C(Sn()),_o=5e3,Mo=6e4,nr=t=>{let e=!1,n=()=>{e&&t.messageBus.publish("user_inactive")};setTimeout(()=>e=!0,Mo);let r=(0,tr.default)(n,_o);return document.body.addEventListener("mousemove",r),document.body.addEventListener("keydown",r),()=>{document.body.removeEventListener("mousemove",r),document.body.removeEventListener("keydown",r)}};d();var rr=t=>{t.messageBus.subscribe("location_change",()=>{var n,r,o;(n=V(t))==null||n.forEach(i=>{let s=i.getSnapshot(),a=s.context.nudge;s.matches({Step:"Render Loop"})&&St(t,a)&&(i==null||i.send({type:"CLOSE"}))});let e=vt(((r=t.organization)==null?void 0:r.shareLinkParam)||Pe,t.location.search);if(e){let i=e.flagKey,s=J(t);if((o=t.nudgesManager)==null||o.send({type:"HANDLE_SHARE_LINK",flagKey:i}),s.find(a=>a.flagKey===i)){let a=new URL(window.location.href);a.searchParams.delete(Pe);let c=a.toString();window.history.replaceState({},document.title,c)}}De(t,{trigger:{type:"active"},source:{type:"active"},overrides:{cooldown:!0,customThrottles:!0,page:!0}}),De(t,{trigger:{type:"immediately"},source:{type:"trigger",properties:{triggerType:"immediately"}}})})};d();var or=t=>{let e=n=>{let r=n.data.action;if(r)r==="startDebugSession"?t.messageBus.publish("start_debug",{event:n}):r==="startRecorderSession"&&t.messageBus.publish("start_recorder",{event:n});else return};return window.addEventListener("message",e),()=>{window.removeEventListener("message",e)}};d();d();var ir=C(Sn());var Ao={observerOptions:{childList:!0,subtree:!0,attributes:!0,attributeFilter:["style","class"]},debounceMs:150},Me=class{constructor(e,n,r=[],o={}){this.mutationObserver=null;this.processMutationsImmediately=()=>{if(this.mutationObserver)try{this.onMutations()}catch(e){w.error("Error processing mutations:",{error:e})}};this.handleMutations=e=>{try{e.some(r=>this.shouldProcessMutation(r))&&this.processMutationsDebounced()}catch(n){w.error("Error handling mutations:",{error:n,mutationCount:e.length})}};this.target=e,this.onMutations=n,this.filters=r,this.options={...Ao,...o},this.processMutationsDebounced=(0,ir.default)(this.processMutationsImmediately,this.options.debounceMs,{maxWait:this.options.debounceMs*2})}shouldProcessMutation(e){if(this.filters.length===0)return!0;try{return this.filters.every(n=>n(e))}catch(n){return w.error("Error in mutation filter:",{error:n,mutation:e}),!1}}cleanup(){var e;this.processMutationsDebounced.cancel(),(e=this.mutationObserver)==null||e.disconnect(),this.mutationObserver=null}observe(){return this.mutationObserver&&this.cleanup(),this.mutationObserver=new MutationObserver(this.handleMutations),this.mutationObserver.observe(this.target,this.options.observerOptions),()=>{this.cleanup()}}};var Po=t=>!(te(t.target)||Array.from(t.addedNodes).some(te)||Array.from(t.removedNodes).some(te)),sr=t=>new Me(document.documentElement,()=>{t.messageBus.publish("dom_mutation")},[Po]).observe();d();d();var oe=C(A());var ar=(t,e,n,r={})=>{var c,m;let o=(c=r==null?void 0:r.renderMode)!=null?c:0;e=Mt(e,t);let i=It(e);if(pe(e)){t.activeChecklist={nudge:e,renderMode:o,defaultOpenIdx:o===1?n:void 0};return}if(Ct(e)){let[u]=e.steps,f=`${e.variantId}-${String(u.id)}${o===1?"-mock":""}`;ae(f,{asChild:!0,element:oe.default.createElement(Un,{forceOpen:r==null?void 0:r.forceOpen,nudge:e,renderMode:o,step:u,anchorOverride:r==null?void 0:r.anchorOverride,handleDestroy:()=>Le(t,e,o),onMarkerView:()=>{if(o===1)return;let l=K(t,e.variantId);se.nudge.tooltipMarkerViewed(e,n,{...l==null?void 0:l.getSnapshot().context,interactionState:j(t,e.variantId)})},onOpen:()=>{o!==1&&se.nudge.viewed(e,n,{...r.context,interactionState:j(t,e.variantId)})}})});return}if(Tt(e)){let[u]=e.steps,f=`${e.variantId}-${String(u.id)}${o===1?"-mock":""}`;xn(f,{element:oe.default.createElement(bn,{nudge:e,stepIndex:n,renderMode:o}),sticky:u==null?void 0:u.formFactor.sticky,position:u==null?void 0:u.formFactor.position});return}let s=G(e,n),a=()=>{i&&Le(t,e,o)};switch(s==null?void 0:s.formFactor.type){case"popover":{let u=`${e.variantId}-${String(s.id)}${o===1?"-mock":""}`,f=s.formFactor.position==="center";ae(u,{element:oe.default.createElement(We,{nudge:e,renderMode:o,stepIndex:n,center:f}),position:s.formFactor.position,duration:Number.POSITIVE_INFINITY,hasWideContent:Oe(s),onEscapeKeyDown:a});break}case"modal":{t.currentModalNudge=mt({nudge:e,stepIndex:n,renderMode:o});break}case"pin":{me(s)&&ae(`${e.variantId}-${String(s.id)}${o===1?"-mock":""}`,{element:oe.default.createElement(vn,{nudge:e,step:s,renderMode:o,stepIndex:n,anchorOverride:r==null?void 0:r.anchorOverride}),duration:Number.POSITIVE_INFINITY,onEscapeKeyDown:a,onEnterKeyDown:()=>Bt(t,e)});break}default:{(m=at())==null||m.captureMessage(`Unknown form factor type: ${s==null?void 0:s.formFactor}`,"error",{captureContext:{tags:{product:"nudges"}}});let u=s&&Oe(s);ae(`${e.variantId}-${String(s==null?void 0:s.id)}${o===1?"-mock":""}`,{element:oe.default.createElement(We,{nudge:e,renderMode:o,stepIndex:n}),position:"top-right",duration:Number.POSITIVE_INFINITY,hasWideContent:u,onEscapeKeyDown:a})}}};d();var cr=(t,e)=>{let n=ee(t);if(!n)return;let r=()=>{e()};return n.addEventListener("click",r),()=>n.removeEventListener("click",r)};d();var dr=(t,e)=>{var n,r;for(let o=0;o<e.steps.length;o++){let i=G(e,o);((n=t.currentModalNudge)==null?void 0:n.renderMode)===1&&(t.currentModalNudge=null),((r=t.activeChecklist)==null?void 0:r.renderMode)===1&&(t.activeChecklist=null),Ke(`${e.variantId}-${String(i==null?void 0:i.id)}-mock`),ze(`${e.variantId}-${String(i==null?void 0:i.id)}-mock`)}},lr=t=>{var e,n;Ht(/-mock$/),kn(/-mock$/),((e=t.currentModalNudge)==null?void 0:e.renderMode)===1&&(t.currentModalNudge=null),((n=t.activeChecklist)==null?void 0:n.renderMode)===1&&(t.activeChecklist=null)},ur=(t,e,n)=>{var o;let r=G(e,n);if(pe(e)){if(!t.activeChecklist)return;t.activeChecklist=null}else xt(r)&&((o=t.currentModalNudge)==null?void 0:o.renderMode)!==1?t.currentModalNudge=null:(Ke(`${e.variantId}-${String(r==null?void 0:r.id)}`),ze(`${e.variantId}-${String(r==null?void 0:r.id)}`))};d();var pr=(t,e)=>{En(t,e)},mr=(t,e)=>{t.resourceCenter.currentContentItemId=e?e.toString():null},gr=(t,e)=>{t.resourceCenter.previewedRecommendationSet=e},fr=(t,e,n)=>{t.resourceCenter={...t.resourceCenter,...e,previewedAdditionalResources:n}},hr=(t,e)=>{t.resourceCenter.customAutopilotKeywords=e};d();var yr=async(t,e)=>{var r,o;let n=()=>{};switch((r=e==null?void 0:e.meta)==null?void 0:r.type){case"intercom":n=()=>window.Intercom("showNewMessage");break;case"helpscout":n=()=>window.Beacon("open");break;case"freshdesk":n=()=>window.FreshworksWidget("open");break;case"freshchat":{n=async()=>window.fcWidget.open();break}case"gist":n=()=>window.gist.chat("open");break;case"crisp":n=()=>{window.$crisp.push(["do","chat:open"]),window.$crisp.push(["do","chat:show"])};break;case"talkdesk_v2":n=()=>{window.webchat.open()};break;case"zendesk":{n=()=>{try{window.zE("messenger","open")}catch(i){window.zE("webWidget","open"),window.zE("webWidget","show")}};break}case"liveChat":n=()=>window.LiveChatWidget.call("maximize");break;case"olark":n=()=>window.olark("api.box.expand");break;case"hubspot":n=()=>window.HubSpotConversations.widget.open();break;case"drift":n=()=>window.drift.api.openChat();break;case"pylon":n=()=>window.Pylon("show")}try{await n()}catch(i){(o=F())==null||o.captureException(i)}},vr=(t,e,n)=>{let r=_t(e.value,t,!0);if(n){window.open(r,"_blank");return}switch(e.operation){case"router":{let o=t.callbacks["engagement-router"];if(o)o(r);else throw new kt("Link is of router type, but router is not defined.");break}case"self":window.open(r,"_self");break;case"blank":window.open(r,"_blank");break;default:window.open(r,"_blank");break}};var br={renderNudge:ar,addClickListener:cr,clickElement:Gt,closeNudgeMock:dr,closeAllNudgeMocks:lr,closeStep:ur,onLocationChange:Ut,postMessageToDashboard:he,openChatExecutable:yr,linkExecutable:vr,getDefaultUIMode:Ft,isElementVisible:Yt,matchesSelector:jt,showResourceCenter:pr,setCurrentContentId:mr,previewRecSet:gr,previewResourceCenter:fr,previewAutopilotKeywords:hr};d();var qe=async(t,e)=>{let n=await fetch(t,{...e,body:e.body!=""?e.body:void 0});return{status:n.status,statusText:n.statusText,headers:Object.fromEntries(n.headers.entries()),data:await n.text(),ok:n.ok}};typeof window<"u"?window.simpleFetch=qe:typeof globalThis<"u"?globalThis.simpleFetch=qe:typeof window<"u"&&(window.simpleFetch=qe);d();var No=t=>{let e=new TextEncoder().encode(t),n=Array.from(e,r=>String.fromCodePoint(r)).join("");return btoa(n)},Oo=t=>{let e=atob(t),n=new TextEncoder().encode(e);return JSON.parse(new TextDecoder().decode(n))};globalThis.base64Encode=No;globalThis.base64Decode=Oo;d();var Bo=t=>!t.target||!te(t.target),Er=t=>{let e=n=>{Bo(n)&&t.messageBus.publish("click",{event:{type:n.type,target:n.target,currentTarget:n.currentTarget,preventDefault:()=>n.preventDefault(),stopPropagation:()=>n.stopPropagation()}})};return document.body.addEventListener("click",e),()=>{document.body.removeEventListener("click",e)}};d();var Do=30,Lo=0,Sr=t=>{let e=null,n=()=>{t.messageBus.publish("exit_intent")},r=i=>{i.clientY>Do||(e=setTimeout(n,Lo))},o=()=>{e&&(clearTimeout(e),e=null)};return document.documentElement.addEventListener("mouseleave",r),document.documentElement.addEventListener("mouseenter",o),()=>{document.body.removeEventListener("mouseleave",r),document.body.removeEventListener("mouseenter",o)}};d();var wr="gs-debug-id",Ir=t=>{t.messageBus.subscribe("location_change",()=>{let n=new URLSearchParams(t.location.search).get(wr);if(n){let r=new URL(window.location.href);r.searchParams.delete(wr);let o=r.toString();window.history.replaceState({},document.title,o),Ot(t,{variantId:Number(n)},{toStepIndex:0})}})};var Ro=()=>{let t=document.getElementById("engagement-wrapper"),e=document.getElementById("engagement-container");return t||(t=document.createElement("div"),t.setAttribute("id","engagement-wrapper"),t.setAttribute("data-engagement","1"),document.body.appendChild(t)),e||(e=document.createElement("div"),e.setAttribute("id","engagement-container"),e.setAttribute("data-engagement","1"),t.appendChild(e)),e},Fo=t=>{switch(t){case"US":return"https://gs.amplitude.com";case"EU":return"https://gs.eu.amplitude.com";default:return"http://localhost:10001"}},Ze={local:"http://localhost:10002/index.js",staging:"https://cdn.amplitude.com/engagement-browser/staging/index.min.js.gz",stag:"https://cdn.amplitude.com/engagement-browser/staging/index.min.js.gz",stag2:"https://cdn.amplitude.com/engagement-browser/staging/index.min.js.gz",rc:"https://cdn.amplitude.com/engagement-browser/rc/index.min.js.gz",prod:"https://cdn.amplitude.com/engagement-browser/prod/index.min.js.gz",prodEu:"https://cdn.amplitude.com/engagement-browser/prod-eu/index.min.js.gz"},Xe={local:"http://localhost:10002/split/index.js",staging:"https://cdn.amplitude.com/engagement-browser/staging/split/index.js",stag:"https://cdn.amplitude.com/engagement-browser/staging/split/index.js",stag2:"https://cdn.amplitude.com/engagement-browser/staging/split/index.js",rc:"https://cdn.amplitude.com/engagement-browser/rc/split/index.js",prod:"https://cdn.amplitude.com/engagement-browser/prod/split/index.js",prodEu:"https://cdn.amplitude.com/engagement-browser/prod-eu/split/index.js"},Je={local:"http://localhost:10001",staging:"https://gs.stag2.amplitude.com",stag:"https://gs.stag2.amplitude.com",stag2:"https://gs.stag2.amplitude.com",prod:"https://gs.amplitude.com",prodUs:"https://gs.amplitude.com",prodEu:"https://gs.eu.amplitude.com"};function Ko(t){let e={};return t.split(";").forEach(r=>{let[o,i]=r.split("=");o&&(e[o]=i)}),e}var Cr=async()=>{var f,l,h,p,b,g;let t=localStorage.getItem("amplitude.engagement.launchCode");if(t){let y=Ko(t),S=document.currentScript||document.getElementById("engagement-sdk-bundle");if(S){let E=window.engagement[P].options.splitting&&(y==null?void 0:y.sdk)!=="local",N=E?Xe==null?void 0:Xe[y==null?void 0:y.sdk]:Ze==null?void 0:Ze[y==null?void 0:y.sdk];if(N&&S.src!==N){(f=S.parentNode)==null||f.removeChild(S);let _=document.createElement("script");_.src=N,_.id="engagement-sdk-bundle";let D=document.querySelector("[nonce]");D&&_.setAttribute("nonce",D.nonce||D.getAttribute("nonce")),E&&_.setAttribute("type","module"),document.getElementsByTagName("head")[0].appendChild(_);return}}if(y!=null&&y.server){let E=Je==null?void 0:Je[y==null?void 0:y.server];E&&(window.engagement[P].serverUrl=E)}}if(((l=window.engagement)==null?void 0:l._initStarted)===!0)return;window.engagement&&(window.engagement._initStarted=!0);let e=window.engagement,{apiKey:n,serverUrl:r,serverZone:o}=e._configuration,i=X.get("takeover","");if(!n)throw new Error("Organization `apiKey` has not been set on the global _configuration object. Make sure you've called `init` before loading this script");let s=X.get("localeOverride","");s&&(e[P].locale=s),e[P].serverUrl=r||Fo(o),e[P].apiKey=n,(h=e[P].options)!=null&&h.logger?console.log("Using custom logger",e[P].options.logger):(console.log("Using default logger"),e[P].options.logger=new st),(p=e[P].options)!=null&&p.logger&&e[P].options.logger.enable((g=(b=e[P].options)==null?void 0:b.logLevel)!=null?g:2),i&&(e[P].apiKey=i),w.log("initializing client SDK..."),Wt();let a=document.getElementById("engagement-is-dashboard-preview-pane")!==null,c=Dt({isEditorPreview:a,platform:Kt(),location:{href:window.location.href,pathname:window.location.pathname,search:window.location.search},services:br,persistResourceCenter:e._configuration.options.persistResourceCenter});Lt(c),Qn(c),er(c),nr(c),Sr(c),sr(c),Er(c),rr(c),Ir(c),or(c);let m=new _e(c,e._configuration);await m._configUser(),m=await Jn(m,e._q),Object.assign(window.engagement,m),Object.setPrototypeOf(window.engagement,m);let u=Ro();xr.default.render(Tr.default.createElement(Hn,{store:c}),u),w.debug("Engagement bundle loaded and container rendered")};he("ENGAGEMENT_LOADED");window.engagement?Cr().catch(console.error):window.engagement=Xn(Cr);var Ld=void 0;export{Ld as default};
